{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ë©˜í† ë©˜í‹° Q&A - ì²­ì„¤ëª¨</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    @font-face {
      font-family: 'MyCustomFont';
      src: url("{% static 'fonts/í”½ì…€.woff2' %}") format('woff2');
    }
    body {
      font-family: 'MyCustomFont', sans-serif;
      margin: 0;
      padding: 0;
      background: url("{% static 'images/Frame 13.png' %}") no-repeat center center fixed;
      background-size: cover;
      background-color: #cde4c7;
    }
    .wrapper {
      max-width: 800px;
      margin: 0 auto;
      padding: 30px 20px;
    }
    .category-bar {
      margin-top: 20px;
      margin-bottom: 15px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }
    .category-bar button {
      background-color: rgba(250, 235, 180, 0.9);
      background-image: url("{% static 'images/pixel-paper.png' %}");
      background-size: 4px 4px;
      border: 2px solid #5a4a2f;
      box-shadow: 2px 2px 0 #b9a782;
      font-family: 'MyCustomFont';
      font-size: 13px;
      font-weight: bold;
      padding: 6px 10px;
      cursor: pointer;
      color: #4a3b28;
    }
    .category-bar .active {
      background-color: #007aff;
      color: white;
    }
    .write-btn {
      background-color: #007aff;
      color: white;
      padding: 6px 12px;
      border: 2px solid #5a4a2f;
      box-shadow: 3px 3px 0 #b9a782;
      font-family: 'MyCustomFont';
      font-weight: bold;
      font-size: 14px;
      cursor: pointer;
      margin-bottom: 20px;
    }
    .post-list {
      display: flex;
      flex-direction: column;
      gap: 14px;
    }
    .post-item {
      background: rgba(250, 235, 180, 0.9);
      background-image: url("{% static 'images/pixel-paper.png' %}");
      background-size: 4px 4px;
      border: 2px solid #5a4a2f;
      box-shadow: 2px 2px 0 #b9a782;
      padding: 12px;
    }
    .post-header {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .category-badge {
      font-size: 12px;
      background: #007aff;
      color: white;
      padding: 2px 6px;
      border-radius: 4px;
    }
    .post-title {
      font-size: 15px;
      font-weight: bold;
      margin: 6px 0;
      color: #222;
    }
    .post-preview {
      font-size: 13px;
      color: #555;
      margin-bottom: 8px;
    }
    .post-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 12px;
      color: #333;
    }
    .meta-info {
      font-size: 12px;
      color: #666;
      margin: 4px 0;
    }
    .mentor-info {
      font-size: 12px;
      color: #333;
    }
    .mentor-profile-btn, .apply-mentoring-btn {
      font-size: 12px;
      padding: 4px 8px;
      background-color: #ffcc00;
      border: 1px solid #5a4a2f;
      font-family: 'MyCustomFont';
      cursor: pointer;
    }
    .sub-category-bar button.active {
    color: #007aff;
    border-color: #007aff;
    font-weight: bold;
  }
  </style>
</head>
<body>
  <div class="wrapper">
    <h2>ğŸ’¬ ë©˜í† ë©˜í‹° ë¬¸ë‹¨ ë¦¬ìŠ¤íŠ¸</h2>
    <div class="meta-info">
  ğŸ‘€ {{ question.views }} |  
  <button class="like-btn" onclick="location.href='{% url 'mentor:question_like' question.id %}'">
    {% if question.user_has_liked %}
      <img src="{% static 'images/heart_filled.png' %}" alt="ì¢‹ì•„ìš”" />
    {% else %}
      <img src="{% static 'images/heart_empty.png' %}" alt="ì¢‹ì•„ìš”" />
    {% endif %}
    {{ question.likes }}
  </button> |
  ğŸ’¬ {{ question.answers.count }}
</div>

    <div class="sub-category-bar">
  {% for code, label in categories.items %}
    <button
      onclick="location.href='?category={{ code }}{% if sort %}&sort={{ sort }}{% endif %}'"
      class="{% if current_category == code %}active{% endif %}"
    >
      {{ label }}
    </button>
  {% endfor %}
</div>

<div class="filter-options" id="filterOptions">
  <a href="?category={{ current_category }}&sort=latest"><button class="{% if sort == 'latest' %}active{% endif %}">ğŸ†• ìµœì‹ ìˆœ</button></a>
  <a href="?category={{ current_category }}&sort=views"><button class="{% if sort == 'views' %}active{% endif %}">ğŸ‘€ ì¡°íšŒìˆœ</button></a>
  <a href="?category={{ current_category }}&sort=likes"><button class="{% if sort == 'likes' %}active{% endif %}">â¤ï¸ ê³µê°ìˆœ</button></a>
  <a href="?category={{ current_category }}&sort=answers"><button class="{% if sort == 'answers' %}active{% endif %}">ğŸ’¬ ë‹µë³€ìˆœ</button></a>
</div>
    
    <div class="category-bar">
      <button class="active">ì „ì²´</button>
      <button>ì¸ìƒì„ ë°°</button><button>ëŒ€í•™ì„ ë°°</button><button>ì—°ì• ì„ ë°°</button><button>ìì·¨ì„ ë°°</button><button>ì·¨ì—…ì„ ë°°</button><button>ì§€ê°‘ì„ ë°°</button><button>ìš´ë™ì„ ë°°</button>
    </div>
    <div class="category-bar">
      <a href="?sort=latest"><button class="{% if sort == 'latest' %}active{% endif %}">ìµœì‹ ìˆœ</button></a>
      <a href="?sort=views"><button class="{% if sort == 'views' %}active{% endif %}">ì¡°íšŒìˆœ</button></a>
      <a href="?sort=likes"><button class="{% if sort == 'likes' %}active{% endif %}">ê³µê°ìˆœ</button></a>
      <a href="?sort=answers"><button class="{% if sort == 'answers' %}active{% endif %}">ë‹µë³€ìˆœ</button></a>
    </div>

    <button class="write-btn" onclick="location.href='{% url 'mentor:question_create' %}'">ê¸€ì“°ê¸°</button>

    <div class="post-list">
      {% for question in questions %}
        <div class="post-item">
          <div class="post-header">
            <span class="category-badge">
              {% if question.category == 'college' %}ğŸ« ëŒ€í•™ì„ ë°•
              {% elif question.category == 'life' %}ğŸŒ± ì¸ìƒì„ ë°•
              {% elif question.category == 'love' %}ğŸ’˜ ì—°ì• ì„ ë°•
              {% elif question.category == 'house' %}ğŸ  ìì¹˜ì„ ë°•
              {% elif question.category == 'job' %}ğŸ’¼ ì¹œì—­ì„ ë°•
              {% elif question.category == 'money' %}ğŸ’³ ì§€ê°‘ì„ ë°•
              {% elif question.category == 'fitness' %}ğŸ’ª ìš´ë™ì„ ë°•
              {% else %}ğŸ“Œ ê¸°íƒ€{% endif %}
            </span>
            <h4 class="post-title">
              <a href="{% url 'mentor:question_detail' question.id %}">{{ question.title }}</a>
            </h4>
          </div>
          <p class="post-preview">{{ question.content|truncatechars:60 }}</p>
          <div class="meta-info">
            ì¡°íšŒìˆ˜: {{ question.views }} | ê³µê°: {{ question.likes }} | ë‹µë³€: {{ question.answers.count }} |
            {{ question.created_at|date:"Y-m-d H:i" }}
          </div>
          <div class="post-footer">
            <div class="mentor-info">
              ğŸ‘¤ <strong>{{ question.author.nickname }}</strong> |
              ğŸ’¼ {{ question.author.profile.job|default:"ì§ì—… ë¯¸ì…ë ¥" }} |
              {{ question.author.bio|default:"ì†Œê°œ ì—†ìŒ" }}
              <button class="mentor-profile-btn" onclick="location.href='/mentor/profile/{{ question.author.id }}'">í”„ë¦¬í¬ì¼</button>
            
      </div>
            {% with answer=question.answers.all.0 %}
            {% if question.first_answer %}
  <a href="{% url 'mentor:mentor_request_direct' question.first_answer.author.id %}">
    <button class="apply-mentoring-btn">ğŸ’¬ ì´ ë‹µë³€ìì—ê²Œ ì¡°ì–¸ êµ¬í•˜ê¸°</button>
  </a>
{% endif %}
            {% endwith %}
          </div>
        </div>
      {% empty %}
        <p>ì•„ì§ ì‘ì„±ëœ ì§ˆë¬¸ì´ ì—†ìŠµë‹ˆë‹¤.</p>
      {% endfor %}
    </div>
  </div>
</body>
</html>