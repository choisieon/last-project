{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ë§ˆì´í˜ì´ì§€ - ì¸ìƒ ë³´ë“œê²Œì„</title>
  <link rel="stylesheet" href="{% static 'css/profile.css' %}" />
</head>
<body>
  <h1>ë‚˜ì˜ ì¸ìƒ ë§ˆì´í˜ì´ì§€</h1>

  <!-- ìƒë‹¨: í”„ë¡œí•„ + ì •ì±… -->
  <div class="top-section">
    <div class="profile-box">
      <div class="avatar-section">
        {% if profile.avatar_image %}
          <img id="avatarImg" src="{{ profile.avatar_image.url }}" alt="ì•„ë°”íƒ€" width="100" height="100">
        {% elif profile.avatar_url %}
          <img id="avatarImg" src="{{ profile.avatar_url }}" alt="ì•„ë°”íƒ€" width="100" height="100">
        {% else %}
          <p>ì•„ë°”íƒ€ê°€ ì•„ì§ ì—†ìŠµë‹ˆë‹¤. ì•„ë˜ ë‚´ìš©ì„ ì±„ì›Œ ì²« ì•„ë°”íƒ€ë¥¼ ìƒì„±í•˜ì„¸ìš”!</p>
        {% endif %}

        {% if profile.avatar_edit_count < 3 %}
        <form id="avatarPromptForm" action="{% url 'accounts:upload_avatar' %}" method="post">
          {% csrf_token %}
          <div>
            <label>ì„±ë³„:</label>
            <input type="text" name="gender" placeholder="ì˜ˆ: ë‚¨ì / ì—¬ì / ì¤‘ì„± ë“±">
          </div>
          <div>
            <label>ìƒê¹€ìƒˆ:</label>
            <input type="text" name="appearance" placeholder="ì˜ˆ: ë°ì€ í”¼ë¶€, í° ëˆˆ, ê·€ì—¬ìš´ ì¸ìƒ ë“±">
          </div>
          <div>
            <label>ë¨¸ë¦¬ìŠ¤íƒ€ì¼:</label>
            <input type="text" name="hair" placeholder="ì˜ˆ: ê¸´ ê°ˆìƒ‰ ë¨¸ë¦¬, ë‹¨ë°œ, í¬ë‹ˆí…Œì¼ ë“±">
          </div>
          <div>
            <label>ì˜· ìŠ¤íƒ€ì¼:</label>
            <input type="text" name="outfit" placeholder="ì˜ˆ: êµë³µ, í›„ë“œí‹°, ìºì£¼ì–¼ ë“±">
          </div>
          <div>
            <label>ì¶”ê°€ ì„¤ëª… (ì„ íƒ):</label>
            <textarea name="custom_detail" rows="2" placeholder="ì˜ˆ: ê³ ì–‘ì´ ê·€, ë¬´ê¸° ë“¤ê³  ìˆìŒ, ë°°ê²½ì— í•˜ëŠ˜ ë“± ììœ ë¡­ê²Œ ì ê¸°"></textarea>
          </div>
          <div>
            <button type="submit">ì•„ë°”íƒ€ {{ profile.avatar_image|yesno:"ìˆ˜ì •í•˜ê¸°,ìƒì„±í•˜ê¸°" }} ({{ 3|add:-profile.avatar_edit_count }}íšŒ ë‚¨ìŒ)</button>
          </div>
        </form>
        {% else %}
          <p>ë” ì´ìƒ ì•„ë°”íƒ€ë¥¼ ìˆ˜ì •í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
        {% endif %}

        <div class="nickname">{{ profile.nickname }}</div>
      </div>
      <div class="info-section-container">
        <div class="info-row"><div class="info-label">ë ˆë²¨</div><div class="info-value">{{ profile.age_range }}</div></div>
        <div class="info-row"><div class="info-label">ì§ì—…</div><div class="info-value">{{ profile.job }}</div></div>
        <div class="info-row"><div class="info-label">ë‚´ê³µ</div><div class="info-value">{{ profile.points }}ì </div></div>
        <div class="info-row"><div class="info-label">ê´€ì‹¬</div><div class="info-value">{{ profile.interests }}</div></div>
        <div class="info-row"><div class="info-label">í•œì¤„</div><div class="info-value">{{ profile.tagline }}</div></div>
      </div>
    </div>
    <div class="policy-banner">
      <h3>ğŸ“Œ ì²­ë…„ ì •ì±… ì¶”ì²œ</h3>
      <ul>
        <li><strong>ì²­ë…„ë‚´ì¼ì±„ìš©ê³µì œ:</strong> ì¤‘ì†Œê¸°ì—… ì¬ì§ ì²­ë…„ì—ê²Œ ëª©ë„ë§Œë…„ ì§€ì›</li>
        <li><strong>ì „ì„¸ë³´ì¦ê¸ˆ ëŒ€ì£¼ ì´ì ì§€ì›:</strong> ìì¹˜/ë…ë¦½ ì²­ë…„ ëŒ€ìƒ</li>
        <li><strong>ì²­ë…„ ì›”ì„¸ ì§€ì›:</strong> ë§Œ 19~34ì„¸ ëŒ€ìƒ, ìµœëŒ€ ì›” 20ë§Œì› ì§€ì›</li>
      </ul>
    </div>
  </div>

  <!-- ì¤‘ë‹¨: ì¸ìƒ ê·¸ë˜í”„ + ë‹¤ë¥¸ì‚¬ëŒ -->
  <h2>ğŸŒ¯ ë‚˜ì˜ ì¸ìƒ ì—¬ì •</h2>
  <div class="middle-section">
    <svg width="100%" height="800" xmlns="http://www.w3.org/2000/svg" style="position:absolute; z-index:0;">
      {% for path in paths %}
        <path d="{{ path }}" stroke="#e1b382" fill="none" stroke-width="4"/>
      {% endfor %}
    </svg>
    <div class="board-map" style="position:relative; z-index:1;">
      {% for event in life_events %}
      <div class="tile" style="width: {{ event.width }}px; height: {{ event.height }}px; left: {{ event.x }}px; top: {{ event.y|default:0 }}px;">
        <div class="year">{{ event.date }}</div>
        <div class="event">{{ event.title }}</div>
        <div class="note">{{ event.note }}</div>
        <div class="metrics"><span>{{ event.feeling }}</span><span>{{ event.score }}</span></div>
        <div class="detail">{{ event.detail }}</div>
      </div>
      {% endfor %}
    </div>
    <div class="others-activity">
      <h3>ğŸ‘¥ ê°™ì€ ì‹œê¸° ë‹¤ë¥¸ ì‚¬ëŒë“¤ì€...</h3>
      <div class="activity-box">
        {% for person in others %}
        <p>ğŸ”¹ <strong>{{ person.name }}</strong> - {{ person.activity }}</p>
        {% endfor %}
      </div>
    </div>
  </div>
</body>
</html>
