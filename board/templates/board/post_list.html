{% extends "base.html" %}
{% load static %}
{% load board_extras %}


{% block title %}
{% if category == 'review' %}í›„ê¸° ê²Œì‹œíŒ | ì²­ì„¤ëª¨{% else %}ì»¤ë®¤ë‹ˆí‹° | ì²­ì„¤ëª¨{% endif %}
{% endblock %}

{% block nav_community_active %}active{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@yaireo/tagify/dist/tagify.css">
<script src="https://cdn.jsdelivr.net/npm/@yaireo/tagify"></script>
{% endblock %}

<!-- âœ… ìˆ˜ì •: category-barì™€ tag-cloudë¥¼ category_bar ë¸”ë¡ìœ¼ë¡œ ì´ë™ -->
{% block category_bar %}
<div class="category-bar">
  <a href="{% url 'board:post_list' %}" class="{% if not category %}active{% endif %}"><button>ì „ì²´</button></a>
  <a href="{% url 'board:post_list' %}?category=review" class="{% if category == 'review' %}active{% endif %}"><button>í›„ê¸°</button></a>
  <a href="{% url 'board:post_list' %}?category=share" class="{% if category == 'share' %}active{% endif %}"><button>ìë£Œê³µìœ </button></a>
  <a href="{% url 'board:post_list' %}?category=free" class="{% if category == 'free' %}active{% endif %}"><button>ì¡ë‹´</button></a>
</div>

<div class="tag-cloud">
  {% for tag in popular_mentor_tags %}
  <a href="?{% if category %}category={{ category }}&{% endif %}tag={{ tag.name }}"
     class="tag{% if tag.name in tag_filter %} active{% endif %}">
    #{{ tag.name }}
  </a>
  {% endfor %}
</div>
{% endblock %}

{% block content %}
<div class="wrapper">
  <!-- í”½ì…€ì•„íŠ¸ ìŠ¤íƒ€ì¼ ê²€ìƒ‰ì°½ê³¼ ì •ë ¬ -->
  <div class="search-sort-bar">
    <form method="get" class="pixel-search-form">
      <input type="text" name="keyword" value="{{ keyword|default_if_none:'' }}" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”" class="pixel-search-input">
      <select name="search_type" class="pixel-search-select">
        <option value="">ì „ì²´</option>
        <option value="author" {% if search_type == 'author' %}selected{% endif %}>ì•„ì´ë””</option>
        <option value="tag" {% if search_type == 'tag' %}selected{% endif %}>íƒœê·¸</option>
        <option value="content" {% if search_type == 'content' %}selected{% endif %}>ë‚´ìš©</option>
      </select>
      <button type="submit" class="pixel-search-btn">ê²€ìƒ‰</button>
      {% if category %}
        <input type="hidden" name="category" value="{{ category }}">
      {% endif %}
      {% for tag in tag_filter %}
        <input type="hidden" name="tag" value="{{ tag }}">
      {% endfor %}
      <input type="hidden" name="sort" value="{{ sort }}">
    </form>
    
    <!-- í”½ì…€ì•„íŠ¸ ìŠ¤íƒ€ì¼ ì •ë ¬ ë“œë¡­ë‹¤ìš´ -->
    <div class="pixel-sort-dropdown">
      <button type="button" class="pixel-sort-btn" onclick="toggleSortDropdown()">
        {% if sort == 'likes' %}â™¥ ì¢‹ì•„ìš”ìˆœ
        {% elif sort == 'comments' %}ğŸ’¬ ëŒ“ê¸€ìˆœ
        {% elif sort == 'views' %}ğŸ‘ ì¡°íšŒìˆ˜ìˆœ
        {% else %}ğŸ“… ìµœì‹ ìˆœ
        {% endif %}
        <span class="pixel-arrow">â–¼</span>
      </button>
      <div id="sortDropdownMenu" class="pixel-sort-menu">
        <a href="?{% if category %}category={{ category }}&{% endif %}{% if keyword %}keyword={{ keyword }}&{% endif %}{% if search_type %}search_type={{ search_type }}&{% endif %}{% for tag in tag_filter %}tag={{ tag }}&{% endfor %}sort=" class="pixel-sort-item {% if not sort %}active{% endif %}">ğŸ“… ìµœì‹ ìˆœ</a>
        <a href="?{% if category %}category={{ category }}&{% endif %}{% if keyword %}keyword={{ keyword }}&{% endif %}{% if search_type %}search_type={{ search_type }}&{% endif %}{% for tag in tag_filter %}tag={{ tag }}&{% endfor %}sort=likes" class="pixel-sort-item {% if sort == 'likes' %}active{% endif %}">â™¥ ì¢‹ì•„ìš”ìˆœ</a>
        <a href="?{% if category %}category={{ category }}&{% endif %}{% if keyword %}keyword={{ keyword }}&{% endif %}{% if search_type %}search_type={{ search_type }}&{% endif %}{% for tag in tag_filter %}tag={{ tag }}&{% endfor %}sort=comments" class="pixel-sort-item {% if sort == 'comments' %}active{% endif %}">ğŸ’¬ ëŒ“ê¸€ìˆœ</a>
        <a href="?{% if category %}category={{ category }}&{% endif %}{% if keyword %}keyword={{ keyword }}&{% endif %}{% if search_type %}search_type={{ search_type }}&{% endif %}{% for tag in tag_filter %}tag={{ tag }}&{% endfor %}sort=views" class="pixel-sort-item {% if sort == 'views' %}active{% endif %}">ğŸ‘ ì¡°íšŒìˆ˜ìˆœ</a>
      </div>
    </div>
  </div>

  {% if keyword %}
    <div class="search-result-label">
      <strong>"{{ keyword }}"</strong>ì— ëŒ€í•œ ê²€ìƒ‰ ê²°ê³¼
    </div>
  {% endif %}

  <!-- ì¸ê¸°ê¸€ ë¦¬ìŠ¤íŠ¸ (íƒ­ ìƒ‰ìƒ êµ¬ë¶„ ì ìš©) -->
  {% if weekly_top_posts %}
    <div class="popular-posts-section">
      <div class="popular-posts-header">
        <span>ğŸ”¥ ì´ë²ˆ ì£¼ ì¸ê¸°ê¸€</span>
      </div>
      <div class="popular-posts-table">
        {% for post in weekly_top_posts|slice:":5" %}
          <div class="popular-post-row">
            <div class="popular-post-category">
              {% if post.category == 'share' %}
                <span class="category-tab tab-share">ìë£Œ</span>
              {% elif post.category == 'free' %}
                <span class="category-tab tab-free">ì¡ë‹´</span>
              {% elif post.category == 'review' %}
                <span class="category-tab tab-review">í›„ê¸°</span>
              {% else %}
                <span class="category-tab">ì „ì²´</span>
              {% endif %}
            </div>
            <div class="popular-post-title">
              <a href="{% url 'board:post_detail' post.pk %}">{{ post.title }}</a>
              <!-- 2. ì œëª© ë°”ë¡œ ì˜†ì— ëŒ“ê¸€ ìˆ˜ í‘œì‹œ -->
              {% if post.comments.count > 0 %}
                <span class="comment-count">[{{ post.comments.count }}]</span>
              {% endif %}
              {# ì´ë¯¸ì§€ ì—¬ë¶€ ì²´í¬ (ì¸ë„¤ì¼ ë˜ëŠ” ì²¨ë¶€ ì´ë¯¸ì§€) #}
              {% if post.thumbnail or post.files.all|any_has_image %}
                <span class="attachment-icon">ğŸ–¼ï¸</span>
              {% endif %}

              {# íŒŒì¼ ì—¬ë¶€ ì²´í¬ #}
              {% if post.files.all|any_has_file %}
                <span class="attachment-icon">ğŸ’¾</span>
              {% endif %}

            </div>
            <div class="popular-post-author">{{ post.author.username }}</div>
            <div class="popular-post-date">{{ post.created_at|date:"m.d" }}</div>
            <div class="popular-post-views">{{ post.views }}</div>
            <div class="popular-post-likes">{{ post.likes.count }}</div>
          </div>
        {% endfor %}
      </div>
    </div>
  {% endif %}

  <!-- í›„ê¸° ê²Œì‹œíŒì€ ê¸°ì¡´ ê·¸ë¦¬ë“œ ë·° ìœ ì§€ -->
  {% if category == 'review' %}
    {% if fixed_posts %}
      {% for post in fixed_posts %}
        <div class="post-item post-item-row notice-row">
          <div class="post-item-text">
            <h4>
              <span class="notice-badge">ê³µì§€</span>
              <a href="{% url 'board:post_detail' post.pk %}?category={{ category }}">{{ post.title }}</a>
            </h4>
            <div class="post-meta">
              <span>ì‘ì„±ì: {{ post.author.username }}</span>
              <span> | {{ post.created_at|date:"Y-m-d H:i" }}</span>
              <span> | ì¡°íšŒìˆ˜: {{ post.views }}</span>
              <span> | â™¥ {{ post.likes.count }}</span>
              <span> | ëŒ“ê¸€: {{ post.comments.count }}</span>
            </div>
            <div class="post-snippet">
              {{ post.content|truncatechars_html:10|safe }}
            </div>
            <div class="post-tags">
              {% for tag in post.tags.all %}
              <a href="{% url 'board:tagged' tag.slug %}" class="post-tag-link">
                #{{ tag.name }}
              </a>
              {% empty %}
              <span style="color:#aaa;">íƒœê·¸ ì—†ìŒ</span>
              {% endfor %}
            </div>
          </div>
        </div>
      {% endfor %}
    {% endif %}
    
    <div class="review-grid">
      {% for post in page_obj %}
        {% if post.thumbnail %}
          <a href="{% url 'board:post_detail' post.pk %}" class="review-card">
            <img src="{{ post.thumbnail.url }}" alt="{{ post.title }}">
            <div class="review-card-body">
              <h3>{{ post.title }}</h3>
              <p>ğŸ‘¤ {{ post.author.username }}</p>
              <p>ğŸ“… {{ post.created_at|date:"Y.m.d" }}</p>
            </div>
          </a>
        {% endif %}
      {% endfor %}
    </div>
    
    <div class="post-list">
      {% for post in page_obj %}
        {% if not post.thumbnail %}
          <div class="post-item post-item-row">
            <div class="post-item-text">
              <h4>
                <a href="{% url 'board:post_detail' post.pk %}?category={{ category }}{% if sort %}&sort={{ sort }}{% endif %}{% if keyword %}&keyword={{ keyword }}{% endif %}">{{ post.title }}</a>
              </h4>
              <div class="post-meta">
                <span>ì‘ì„±ì: {{ post.author.username }}</span>
                <span> | {{ post.created_at|date:"Y-m-d H:i" }}</span>
                <span> | ì¡°íšŒìˆ˜: {{ post.views }}</span>
                <span> | â™¥ {{ post.likes.count }}</span>
                <span> | ëŒ“ê¸€: {{ post.comments.count }}</span>
              </div>
              <div class="post-snippet">
                {{ post.content|truncatechars_html:10|safe }}
              </div>
              <div class="post-tags">
                {% for tag in post.tags.all %}
                <a href="{% url 'board:tagged' tag.slug %}" class="post-tag-link">
                  #{{ tag.name }}
                </a>
                {% empty %}
                <span style="color:#aaa;">íƒœê·¸ ì—†ìŒ</span>
                {% endfor %}
              </div>
            </div>
          </div>
        {% endif %}
      {% endfor %}
    </div>

  {% else %}
    <!-- ì „ì²´/ìë£Œê³µìœ /ì¡ë‹´ ê²Œì‹œíŒ: í…Œì´ë¸” í˜•íƒœ ë¦¬ìŠ¤íŠ¸ -->
    
    <!-- ì»¬ëŸ¼ í—¤ë” -->
    <div class="post-table-header">
      <div class="header-category">íƒ­</div>
      <div class="header-title">ì œëª©</div>
      <div class="header-author">ì‘ì„±ì</div>
      <div class="header-date">ì‘ì„±ì¼</div>
      <div class="header-views">ì¡°íšŒ</div>
      <div class="header-likes">ì¢‹ì•„ìš”</div>
    </div>

    <!-- ê³µì§€ê¸€ -->
    <div class="post-table">
      {% for post in fixed_posts %}
        <div class="post-table-row notice-table-row">
          <div class="post-category">
            <span class="notice-badge-small tab-notice">ê³µì§€</span>
          </div>
          <div class="post-title">
            <a href="{% url 'board:post_detail' post.pk %}?category={{ category }}">{{ post.title }}</a>
            <!-- 2,3. ì œëª© ë°”ë¡œ ì˜†ì— ëŒ“ê¸€ ìˆ˜ì™€ ì²¨ë¶€íŒŒì¼ í‘œì‹œ -->
            {% if post.comments.count > 0 %}
              <span class="comment-count">[{{ post.comments.count }}]</span>
            {% endif %}
            {# ì´ë¯¸ì§€ ì—¬ë¶€ ì²´í¬ (ì¸ë„¤ì¼ ë˜ëŠ” ì²¨ë¶€ ì´ë¯¸ì§€) #}
            {% if post.thumbnail or post.files.all|any_has_image %}
              <span class="attachment-icon">ğŸ–¼ï¸</span>
            {% endif %}

            {# íŒŒì¼ ì—¬ë¶€ ì²´í¬ #}
            {% if post.files.all|any_has_file %}
              <span class="attachment-icon">ğŸ’¾</span>
            {% endif %}

          </div>
          <div class="post-author">{{ post.author.username }}</div>
          <div class="post-date">{{ post.created_at|date:"m.d" }}</div>
          <div class="post-views">{{ post.views }}</div>
          <div class="post-likes">{{ post.likes.count }}</div>
        </div>
      {% endfor %}
      
      <!-- ì¼ë°˜ ê²Œì‹œê¸€ (ê¹”ë”í•œ íƒ­ ìƒ‰ìƒ êµ¬ë¶„) -->
      {% for post in page_obj %}
        <div class="post-table-row">
          <div class="post-category">
            {% if post.category == 'share' %}
              <span class="category-tab tab-share">ìë£Œ</span>
            {% elif post.category == 'free' %}
              <span class="category-tab tab-free">ì¡ë‹´</span>
            {% elif post.category == 'review' %}
              <span class="category-tab tab-review">í›„ê¸°</span>
            {% else %}
              <span class="category-tab">ì „ì²´</span>
            {% endif %}
          </div>
          <div class="post-title">
            <a href="{% url 'board:post_detail' post.pk %}?category={{ category }}{% if sort %}&sort={{ sort }}{% endif %}{% if keyword %}&keyword={{ keyword }}{% endif %}">{{ post.title }}</a>
            <!-- 2,3. ì œëª© ë°”ë¡œ ì˜†ì— ëŒ“ê¸€ ìˆ˜ì™€ ì²¨ë¶€íŒŒì¼ í‘œì‹œ -->
            {% if post.comments.count > 0 %}
              <span class="comment-count">[{{ post.comments.count }}]</span>
            {% endif %}
            {# ì´ë¯¸ì§€ ì—¬ë¶€ ì²´í¬ (ì¸ë„¤ì¼ ë˜ëŠ” ì²¨ë¶€ ì´ë¯¸ì§€) #}
            {% if post.thumbnail or post.files.all|any_has_image %}
              <span class="attachment-icon">ğŸ–¼ï¸</span>
            {% endif %}

            {# íŒŒì¼ ì—¬ë¶€ ì²´í¬ #}
            {% if post.files.all|any_has_file %}
              <span class="attachment-icon">ğŸ’¾</span>
            {% endif %}

          </div>
          <div class="post-author">{{ post.author.username }}</div>
          <div class="post-date">{{ post.created_at|date:"m.d" }}</div>
          <div class="post-views">{{ post.views }}</div>
          <div class="post-likes">{{ post.likes.count }}</div>
        </div>
      {% empty %}
        <div class="post-table-empty">
          ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤.
        </div>
      {% endfor %}
    </div>
  {% endif %}

  <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
  <div class="pagination">
    {% if page_obj.has_previous %}
    <a href="?page=1{% if sort %}&sort={{ sort }}{% endif %}{% if keyword %}&keyword={{ keyword }}{% endif %}{% if search_type %}&search_type={{ search_type }}{% endif %}{% for tag in tag_filter %}&tag={{ tag }}{% endfor %}">Â« ì²˜ìŒ</a>
    <a href="?page={{ page_obj.previous_page_number }}{% if sort %}&sort={{ sort }}{% endif %}{% if keyword %}&keyword={{ keyword }}{% endif %}{% if search_type %}&search_type={{ search_type }}{% endif %}{% for tag in tag_filter %}&tag={{ tag }}{% endfor %}">â€¹ ì´ì „</a>
    {% endif %}
    {% for num in page_obj.paginator.page_range %}
    {% if page_obj.number == num %}
    <strong>{{ num }}</strong>
    {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
    <a href="?page={{ num }}{% if sort %}&sort={{ sort }}{% endif %}{% if keyword %}&keyword={{ keyword }}{% endif %}{% if search_type %}&search_type={{ search_type }}{% endif %}{% for tag in tag_filter %}&tag={{ tag }}{% endfor %}">{{ num }}</a>
    {% endif %}
    {% endfor %}
    {% if page_obj.has_next %}
    <a href="?page={{ page_obj.next_page_number }}{% if sort %}&sort={{ sort }}{% endif %}{% if keyword %}&keyword={{ keyword }}{% endif %}{% if search_type %}&search_type={{ search_type }}{% endif %}{% for tag in tag_filter %}&tag={{ tag }}{% endfor %}">ë‹¤ìŒ â€º</a>
    <a href="?page={{ page_obj.paginator.num_pages }}{% if sort %}&sort={{ sort }}{% endif %}{% if keyword %}&keyword={{ keyword }}{% endif %}{% if search_type %}&search_type={{ search_type }}{% endif %}{% for tag in tag_filter %}&tag={{ tag }}{% endfor %}">ë§ˆì§€ë§‰ Â»</a>
    {% endif %}
  </div>
</div>
{% endblock %}

{% block extra_script %}
<script>
document.addEventListener('DOMContentLoaded', function() {
  var tagInput = document.getElementById('custom-tags');
  if (tagInput) {
    new Tagify(tagInput, {
      whitelist: [{% for tag in popular_mentor_tags %}"{{ tag.name }}"{% if not forloop.last %},{% endif %}{% endfor %}],
      dropdown: { maxItems: 10 }
    });
  }
});

// ì •ë ¬ ë“œë¡­ë‹¤ìš´ í† ê¸€ í•¨ìˆ˜
function toggleSortDropdown() {
  const menu = document.getElementById('sortDropdownMenu');
  menu.style.display = menu.style.display === 'none' ? 'block' : 'none';
}

// ë“œë¡­ë‹¤ìš´ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
document.addEventListener('click', function(event) {
  const dropdown = document.querySelector('.pixel-sort-dropdown');
  const menu = document.getElementById('sortDropdownMenu');
  if (dropdown && !dropdown.contains(event.target)) {
    menu.style.display = 'none';
  }
});
</script>
{% endblock %}

{% block extra_style %}
<style>
.top-nav,
.category-bar,
.tag-cloud {
  max-width: 900px;
  margin-left: auto;
  margin-right: auto;
  box-sizing: border-box;
  padding-left: 0;
  padding-right: 0;
}

/* âœ… ìˆ˜ì •: ìƒìœ„ ë„¤ë¹„ê²Œì´ì…˜ê³¼ ì •ë ¬ ë§ì¶¤ ë° ê°„ê²© ìµœì†Œí™” */
.top-nav {
  margin-bottom: 6px;   /* 20px â†’ 6px (ìœ„ ê°„ê²© ìµœì†Œí™”) */
}
.category-bar {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  justify-content: flex-start;
  padding: 0;
  margin-top: 0;
  margin-bottom: 8px;   /* íƒœê·¸ì™€ì˜ ê°„ê²© */
}

.category-bar button {
  background-color: rgba(250, 235, 180, 0.9);
  background-image: url("{% static 'images/pixel-paper.png' %}");
  background-size: 4px 4px;
  background-repeat: repeat;
  border: 2px solid #5a4a2f;
  box-shadow: 2px 2px 0 #b9a782;
  font-size: 13px;
  font-weight: bold;
  padding: 6px 16px;
  cursor: pointer;
  color: #4a3b28;
  transition: all 0.1s ease;
  min-width: 75px;
}

.category-bar button:hover {
  transform: translate(1px, 1px);
  box-shadow: 1px 1px 0 #b9a782;
}

.category-bar a.active button {
  background-color: rgba(250, 235, 180, 0.9);
  background-image: url("{% static 'images/pixel-paper.png' %}");
  color: #007aff;
  border-color: #5a4a2f;
  box-shadow: 2px 2px 0 #b9a782;
}

/* âœ… ìˆ˜ì •: íƒœê·¸ í´ë¼ìš°ë“œë„ ì¤‘ì•™ ì •ë ¬ ë° ê°„ê²© ìµœì†Œí™” */
.tag-cloud {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  justify-content: flex-start;
  padding: 0;
  margin-top: 0;
  margin-bottom: 6px;   /* ë³¸ë¬¸ê³¼ì˜ ê°„ê²© */
}

.tag-cloud .tag {
  background-color: rgba(240, 248, 255, 0.95);
  background-image: url("{% static 'images/pixel-paper.png' %}");
  background-size: 3px 3px;
  background-repeat: repeat;
  color: #0066cc;
  text-decoration: none;
  padding: 4px 10px;
  border: 2px solid #4682b4;
  box-shadow: 2px 2px 0 #87ceeb;
  font-size: 11px;
  font-weight: bold;
  transition: all 0.1s ease;
}

.tag-cloud .tag:hover {
  background-color: #4682b4;
  color: #ffffff;
  transform: translate(1px, 1px);
  box-shadow: 1px 1px 0 #87ceeb;
}

.tag-cloud .tag.active {
  background-color: #0066cc;
  color: #ffffff;
  box-shadow: 2px 2px 0 #87ceeb;
}

/* í”½ì…€ì•„íŠ¸ ìŠ¤íƒ€ì¼ ê²€ìƒ‰ì°½ */
.search-sort-bar {
  margin-bottom: 25px;
  display: flex;
  gap: 12px;
  align-items: center;
  flex-wrap: wrap;
  justify-content: center;
}

.pixel-search-form {
  display: flex;
  gap: 6px;
  align-items: center;
  flex-wrap: wrap;
}

.pixel-search-input {
  padding: 7px 11px;
  border: 2px solid #8b4513;
  background-color: rgba(255, 248, 220, 0.95);
  background-image: url("{% static 'images/pixel-paper.png' %}");
  background-size: 3px 3px;
  background-repeat: repeat;
  box-shadow: 2px 2px 0 #cd853f;
  font-size: 13px;
  font-weight: bold;
  color: #4a3b28;
  outline: none;
  min-width: 180px;
}

.pixel-search-input:focus {
  background-color: #ffffff;
  border-color: #ff6347;
  box-shadow: 2px 2px 0 #ffa07a;
}

.pixel-search-select {
  padding: 7px 9px;
  border: 2px solid #8b4513;
  background-color: rgba(245, 222, 179, 0.95);
  background-image: url("{% static 'images/pixel-paper.png' %}");
  background-size: 3px 3px;
  background-repeat: repeat;
  box-shadow: 2px 2px 0 #cd853f;
  font-size: 12px;
  font-weight: bold;
  color: #4a3b28;
  cursor: pointer;
}

.pixel-search-btn {
  padding: 7px 14px;
  border: 2px solid #228b22;
  background-color: rgba(144, 238, 144, 0.95);
  background-image: url("{% static 'images/pixel-paper.png' %}");
  background-size: 3px 3px;
  background-repeat: repeat;
  box-shadow: 2px 2px 0 #32cd32;
  color: #006400;
  font-weight: bold;
  font-size: 13px;
  cursor: pointer;
  transition: all 0.1s ease;
}

.pixel-search-btn:hover {
  background-color: #32cd32;
  transform: translate(1px, 1px);
  box-shadow: 1px 1px 0 #32cd32;
}

/* í”½ì…€ì•„íŠ¸ ìŠ¤íƒ€ì¼ ì •ë ¬ ë“œë¡­ë‹¤ìš´ */
.pixel-sort-dropdown {
  position: relative;
}

.pixel-sort-btn {
  padding: 7px 14px;
  border: 2px solid #ff4500;
  background-color: rgba(255, 165, 0, 0.95);
  background-image: url("{% static 'images/pixel-paper.png' %}");
  background-size: 3px 3px;
  background-repeat: repeat;
  box-shadow: 2px 2px 0 #ff6347;
  color: #8b0000;
  font-weight: bold;
  font-size: 13px;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 6px;
  transition: all 0.1s ease;
}

.pixel-sort-btn:hover {
  background-color: #ff6347;
  transform: translate(1px, 1px);
  box-shadow: 1px 1px 0 #ff6347;
}

.pixel-sort-menu {
  display: none;
  position: absolute;
  top: 100%;
  right: 0;
  background-color: rgba(255, 248, 220, 0.98);
  background-image: url("{% static 'images/pixel-paper.png' %}");
  background-size: 3px 3px;
  background-repeat: repeat;
  border: 2px solid #8b4513;
  box-shadow: 3px 3px 0 #cd853f;
  z-index: 1000;
  min-width: 130px;
  margin-top: 3px;
}

.pixel-sort-item {
  display: block;
  padding: 7px 11px;
  color: #4a3b28;
  text-decoration: none;
  font-weight: bold;
  font-size: 12px;
  border-bottom: 1px solid #deb887;
  transition: all 0.1s ease;
}

.pixel-sort-item:last-child {
  border-bottom: none;
}

.pixel-sort-item:hover {
  background-color: rgba(245, 222, 179, 0.8);
  color: #8b4513;
}

.pixel-sort-item.active {
  background-color: #007aff;
  color: #ffffff;
}

/* ê¹”ë”í•œ íƒ­ ìƒ‰ìƒ êµ¬ë¶„ (ê³µì§€/í›„ê¸°/ìë£Œê³µìœ /ì¡ë‹´ë§Œ) */
.category-tab {
  display: inline-block;
  padding: 3px 7px;
  border-radius: 3px;
  font-size: 10px;
  font-weight: bold;
  color: #ffffff;
  text-align: center;
  min-width: 30px;
}

.tab-share {
  background-color: #4CAF50;
}

.tab-free {
  background-color: #2196F3;
}

.tab-review {
  background-color: #E91E63;
}

.tab-notice {
  background-color: #FF9800;
  color: #ffffff;
}

/* ì¸ê¸°ê¸€ ì„¹ì…˜ */
.popular-posts-section {
  margin-bottom: 25px;
}

.popular-posts-header {
  padding: 11px 15px;
  background: linear-gradient(135deg, #ff6f00 0%, #ff8f00 100%);
  color: #fff;
  font-weight: bold;
  font-size: 1.02rem;
  border-radius: 7px 7px 0 0;
  display: flex;
  align-items: center;
  gap: 7px;
}

.popular-posts-table {
  border: 2px solid #ff8f00;
  border-top: none;
  border-radius: 0 0 7px 7px;
  background: #fff;
  overflow: hidden;
}

.popular-post-row {
  display: grid;
  grid-template-columns: 60px 1fr 100px 80px 60px 60px;
  gap: 9px;
  padding: 9px 15px;
  border-bottom: 1px solid #f0f0f0;
  align-items: center;
  transition: background-color 0.2s;
  background: linear-gradient(135deg, #fff8e1 0%, #ffecb3 100%);
  border-left: 3px solid #ff9800;
}

.popular-post-row:hover {
  background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);
}

.popular-post-row:last-child {
  border-bottom: none;
}

.popular-post-category {
  text-align: center;
  font-size: 1rem;
}

.popular-post-title {
  font-size: 0.93rem;
  display: flex;
  align-items: center;
  gap: 0;
  flex-wrap: wrap;
}

.popular-post-title a {
  color: #e65100;
  text-decoration: none;
  font-weight: bold;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  max-width: none;
  flex-shrink: 1;
}

.popular-post-title a:hover {
  color: #bf360c;
  text-decoration: underline;
}

.popular-post-author, .popular-post-date, .popular-post-views, .popular-post-likes {
  color: #666;
  font-size: 0.88rem;
  text-align: center;
}

/* í…Œì´ë¸” í˜•íƒœ ê²Œì‹œíŒ ìŠ¤íƒ€ì¼ */
.post-table-header {
  display: grid;
  grid-template-columns: 60px 1fr 100px 80px 60px 60px;
  gap: 9px;
  padding: 11px 15px;
  background: #f8f9fa;
  border: 2px solid #dee2e6;
  border-bottom: 1px solid #dee2e6;
  border-radius: 7px 7px 0 0;
  font-weight: bold;
  color: #495057;
  font-size: 0.93rem;
}

.post-table {
  border: 2px solid #dee2e6;
  border-top: none;
  border-radius: 0 0 7px 7px;
  background: #fff;
  overflow: hidden;
}

.post-table-row {
  display: grid;
  grid-template-columns: 60px 1fr 100px 80px 60px 60px;
  gap: 9px;
  padding: 11px 15px;
  border-bottom: 1px solid #f0f0f0;
  align-items: center;
  transition: background-color 0.2s;
}

.post-table-row:hover {
  background-color: #f8f9fa;
}

.post-table-row:last-child {
  border-bottom: none;
}

.notice-table-row {
  background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%) !important;
  border-left: 4px solid #ff9800 !important;
}

.notice-table-row:hover {
  background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%) !important;
}

.post-category {
  text-align: center;
  font-size: 0.98rem;
}

.category-icon {
  font-size: 1.05rem;
  color: #666;
}

.notice-badge-small {
  font-size: 10px;
  font-weight: bold;
  background-color: #FF9800;
  color: #ffffff;
  padding: 3px 7px;
  border-radius: 3px;
}

.post-title {
  font-size: 0.93rem;
  display: flex;
  align-items: center;
  gap: 0;
  flex-wrap: wrap;
}

.post-title a {
  color: #333;
  text-decoration: none;
  font-weight: bold;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  max-width: none;
  flex-shrink: 1;
}

.post-title a:hover {
  color: #1976d2;
  text-decoration: underline;
}

/* 2. ëŒ“ê¸€ ìˆ˜ë¥¼ ì œëª© ë°”ë¡œ ì˜†ì— ë¶™ì´ê¸° */
.comment-count {
  color: #e65100;
  font-weight: bold;
  font-size: 0.85rem;
  margin-left: 3px;
  flex-shrink: 0;
  white-space: nowrap;
}

/* 3. ì²¨ë¶€íŒŒì¼ ì´ëª¨í‹°ì½˜ í‘œì‹œ */
.attachment-icon {
  color: #666;
  font-size: 0.9rem;
  margin-left: 4px;
  flex-shrink: 0;
  white-space: nowrap;
}

.post-author {
  color: #666;
  font-size: 0.88rem;
  text-align: center;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.post-date {
  color: #666;
  font-size: 0.88rem;
  text-align: center;
}

.post-views, .post-likes {
  color: #666;
  font-size: 0.88rem;
  text-align: center;
}

.post-table-empty {
  padding: 35px;
  text-align: center;
  color: #aaa;
  font-style: italic;
}

/* ê³µì§€ê¸€ ìŠ¤íƒ€ì¼ */
.notice-row {
  background: linear-gradient(135deg, #fff8e1 0%, #ffecb3 100%) !important;
  border-left: 4px solid #ff9800 !important;
}
.notice-badge {
  display: inline-block;
  background: #ff9800;
  color: #fff;
  font-weight: bold;
  font-size: 0.83rem;
  padding: 3px 7px;
  border-radius: 11px;
  margin-right: 7px;
}

/* í”½ì…€ì•„íŠ¸ ìŠ¤íƒ€ì¼ íƒœê·¸ ë§í¬ */
.post-tags {
  margin: 5px 0 0 0;
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
}

.post-tag-link {
  display: inline-block;
  background-color: rgba(230, 243, 255, 0.9);
  background-image: url("{% static 'images/pixel-paper.png' %}");
  background-size: 2px 2px;
  background-repeat: repeat;
  color: #0066cc;
  text-decoration: none;
  padding: 2px 7px;
  border: 1px solid #4682b4;
  box-shadow: 1px 1px 0 #87ceeb;
  font-size: 10px;
  font-weight: bold;
  transition: all 0.1s ease;
}

.post-tag-link:hover {
  background-color: #4682b4;
  color: #ffffff;
  transform: translate(1px, 1px);
  box-shadow: 0px 0px 0 #87ceeb;
}

/* ê²€ìƒ‰ ê²°ê³¼ ë¼ë²¨ */
.search-result-label {
  margin-bottom: 18px;
  color: #333;
  font-weight: bold;
  background-color: rgba(255, 250, 205, 0.9);
  background-image: url("{% static 'images/pixel-paper.png' %}");
  background-size: 3px 3px;
  background-repeat: repeat;
  border: 2px solid #daa520;
  box-shadow: 2px 2px 0 #b8860b;
  padding: 7px 11px;
  font-size: 13px;
  text-align: center;
}

/* ê¸°ì¡´ ìŠ¤íƒ€ì¼ ìœ ì§€ */
.post-list {
  margin-bottom: 18px;
}
.post-item-row {
  display: flex;
  align-items: flex-start;
  gap: 1.1rem;
  margin-bottom: 22px;
  border: 1px solid #fbc02d;
  border-radius: 7px;
  background: #fff;
  padding: 15px;
}
.post-item-text {
  flex: 1;
  min-width: 0;
}

/* í”½ì…€ì•„íŠ¸ ìŠ¤íƒ€ì¼ í˜ì´ì§€ë„¤ì´ì…˜ */
.pagination {
  margin-top: 30px;
  text-align: center;
}
.pagination a, .pagination strong {
  display: inline-block;
  margin: 0 3px;
  padding: 5px 9px;
  border: 2px solid #4682b4;
  background-color: rgba(240, 248, 255, 0.9);
  background-image: url("{% static 'images/pixel-paper.png' %}");
  background-size: 2px 2px;
  background-repeat: repeat;
  box-shadow: 2px 2px 0 #87ceeb;
  color: #0066cc;
  text-decoration: none;
  font-weight: bold;
  font-size: 12px;
  transition: all 0.1s ease;
}
.pagination a:hover {
  background-color: #4682b4;
  color: #ffffff;
  transform: translate(1px, 1px);
  box-shadow: 1px 1px 0 #87ceeb;
}
.pagination strong {
  background-color: #0066cc;
  color: #ffffff;
  border-color: #003d7a;
  box-shadow: 2px 2px 0 #4682b4;
}

/* í›„ê¸° ê·¸ë¦¬ë“œ ìŠ¤íƒ€ì¼ */
.review-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(210px, 1fr));
  gap: 22px;
  margin-top: 28px;
  margin-bottom: 28px;
}
.review-card {
  display: block;
  background: #fff;
  border: 2px solid #fbc02d;
  border-radius: 11px;
  box-shadow: 2px 2px 7px #b9a78233;
  overflow: hidden;
  text-decoration: none;
  color: #222;
  transition: box-shadow 0.2s, border 0.2s;
}
.review-card:hover {
  border: 2px solid #007aff;
  box-shadow: 4px 4px 11px #1976d233;
}
.review-card img {
  width: 100%;
  height: 170px;
  object-fit: cover;
  background: #eee;
}
.review-card-body {
  padding: 15px 13px 9px 13px;
}
.review-card-body h3 {
  font-size: 1.1rem;
  margin-bottom: 6px;
}
.review-card-body p {
  margin: 0 0 3px 0;
  color: #555;
  font-size: 0.96em;
}

/* ë°˜ì‘í˜• ìŠ¤íƒ€ì¼ */
@media (max-width: 768px) {
  .search-sort-bar {
    flex-direction: column;
    align-items: center;
    gap: 8px;
  }
  
  .pixel-search-form {
    flex-direction: column;
    gap: 6px;
    width: 100%;
    max-width: 380px;
  }
  
  .pixel-search-input {
    min-width: auto;
    width: 100%;
  }
  
  .post-table-header, .post-table-row, .popular-post-row {
    grid-template-columns: 45px 1fr 65px 55px 40px 40px;
    gap: 5px;
    padding: 7px 11px;
    font-size: 0.82rem;
  }
  
  .category-bar {
    gap: 6px;
    padding: 1px 0;
  }
  
  .category-bar button {
    padding: 4px 10px;
    font-size: 12px;
    min-width: 65px;
  }
  
  .tag-cloud {
    gap: 4px;
    padding: 1px 0;
  }
  
  .tag-cloud .tag {
    font-size: 10px;
    padding: 3px 7px;
  }
  
  /* ëª¨ë°”ì¼ì—ì„œ ì œëª©, ëŒ“ê¸€, ì²¨ë¶€íŒŒì¼ ê°„ê²© ì¡°ì • */
  .comment-count {
    font-size: 0.8rem;
    margin-left: 2px;
  }
  
  .attachment-icon {
    font-size: 0.85rem;
    margin-left: 3px;
  }
}

@media (max-width: 600px) {
  .post-item-row {
    flex-direction: column;
    gap: 0.6rem;
  }
  .review-card img {
    height: 110px;
  }
  
  .pixel-search-input, .pixel-search-select, .pixel-search-btn {
    width: 100%;
  }
  
  .category-bar button {
    padding: 3px 8px;
    font-size: 11px;
    min-width: 60px;
  }
}
</style>
{% endblock %}
